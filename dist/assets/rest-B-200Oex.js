var Jr=Object.defineProperty;var o=(e,r)=>Jr(e,"name",{value:r,configurable:!0});import{g as Gr,c as Te}from"./client-CoXyEgsn.js";import"./index-VeQlQ-OT.js";var Xr=Object.defineProperty,Yr=o((e,r,t)=>r in e?Xr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,"Kt"),v=o((e,r,t)=>(Yr(e,typeof r!="symbol"?r+"":r,t),t),"p"),k=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}o(mr,"lt");var Zr=Array.isArray,E=Zr,Kr=typeof k=="object"&&k&&k.Object===Object&&k,jr=Kr,et=jr,rt=typeof self=="object"&&self&&self.Object===Object&&self,tt=et||rt||Function("return this")(),O=tt,nt=O,at=nt.Symbol,U=at,Ie=U,_r=Object.prototype,ot=_r.hasOwnProperty,it=_r.toString,z=Ie?Ie.toStringTag:void 0;function st(e){var r=ot.call(e,z),t=e[z];try{e[z]=void 0;var n=!0}catch{}var a=it.call(e);return n&&(r?e[z]=t:delete e[z]),a}o(st,"Zt");var ct=st,ut=Object.prototype,lt=ut.toString;function ft(e){return lt.call(e)}o(ft,"rr");var dt=ft,Pe=U,ht=ct,pt=dt,yt="[object Null]",bt="[object Undefined]",ze=Pe?Pe.toStringTag:void 0;function vt(e){return e==null?e===void 0?bt:yt:ze&&ze in Object(e)?ht(e):pt(e)}o(vt,"cr");var R=vt;function gt(e){return e!=null&&typeof e=="object"}o(gt,"lr");var C=gt,mt=R,jt=C,_t="[object Symbol]";function wt(e){return typeof e=="symbol"||jt(e)&&mt(e)==_t}o(wt,"hr");var he=wt,Ot=E,At=he,xt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Et=/^\w*$/;function Ct(e,r){if(Ot(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||At(e)?!0:Et.test(e)||!xt.test(e)||r!=null&&e in Object(r)}o(Ct,"vr");var Nt=Ct;function $t(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}o($t,"_r");var $=$t,St=R,qt=$,Tt="[object AsyncFunction]",It="[object Function]",Pt="[object GeneratorFunction]",zt="[object Proxy]";function Ut(e){if(!qt(e))return!1;var r=St(e);return r==It||r==Pt||r==Tt||r==zt}o(Ut,"Sr");var wr=Ut,Rt=O,Bt=Rt["__core-js_shared__"],Mt=Bt,re=Mt,Ue=function(){var e=/[^.]+$/.exec(re&&re.keys&&re.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function kt(e){return!!Ue&&Ue in e}o(kt,"Pr");var Ft=kt,Dt=Function.prototype,Lt=Dt.toString;function Qt(e){if(e!=null){try{return Lt.call(e)}catch{}try{return e+""}catch{}}return""}o(Qt,"Rr");var Or=Qt,Vt=wr,Wt=Ft,Ht=$,Jt=Or,Gt=/[\\^$.*+?()[\]{}|]/g,Xt=/^\[object .+?Constructor\]$/,Yt=Function.prototype,Zt=Object.prototype,Kt=Yt.toString,en=Zt.hasOwnProperty,rn=RegExp("^"+Kt.call(en).replace(Gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tn(e){if(!Ht(e)||Wt(e))return!1;var r=Vt(e)?rn:Xt;return r.test(Jt(e))}o(tn,"Jr");var nn=tn;function an(e,r){return e==null?void 0:e[r]}o(an,"Wr");var on=an,sn=nn,cn=on;function un(e,r){var t=cn(e,r);return sn(t)?t:void 0}o(un,"kr");var N=un,ln=N,fn=ln(Object,"create"),J=fn,Re=J;function dn(){this.__data__=Re?Re(null):{},this.size=0}o(dn,"ra");var hn=dn;function pn(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}o(pn,"na");var yn=pn,bn=J,vn="__lodash_hash_undefined__",gn=Object.prototype,mn=gn.hasOwnProperty;function jn(e){var r=this.__data__;if(bn){var t=r[e];return t===vn?void 0:t}return mn.call(r,e)?r[e]:void 0}o(jn,"ua");var _n=jn,wn=J,On=Object.prototype,An=On.hasOwnProperty;function xn(e){var r=this.__data__;return wn?r[e]!==void 0:An.call(r,e)}o(xn,"pa");var En=xn,Cn=J,Nn="__lodash_hash_undefined__";function $n(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Cn&&r===void 0?Nn:r,this}o($n,"$a");var Sn=$n,qn=hn,Tn=yn,In=_n,Pn=En,zn=Sn;function S(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}o(S,"E");S.prototype.clear=qn;S.prototype.delete=Tn;S.prototype.get=In;S.prototype.has=Pn;S.prototype.set=zn;var Un=S;function Rn(){this.__data__=[],this.size=0}o(Rn,"Sa");var Bn=Rn;function Mn(e,r){return e===r||e!==e&&r!==r}o(Mn,"Ea");var pe=Mn,kn=pe;function Fn(e,r){for(var t=e.length;t--;)if(kn(e[t][0],r))return t;return-1}o(Fn,"Pa");var G=Fn,Dn=G,Ln=Array.prototype,Qn=Ln.splice;function Vn(e){var r=this.__data__,t=Dn(r,e);if(t<0)return!1;var n=r.length-1;return t==n?r.pop():Qn.call(r,t,1),--this.size,!0}o(Vn,"Ra");var Wn=Vn,Hn=G;function Jn(e){var r=this.__data__,t=Hn(r,e);return t<0?void 0:r[t][1]}o(Jn,"Fa");var Gn=Jn,Xn=G;function Yn(e){return Xn(this.__data__,e)>-1}o(Yn,"Ga");var Zn=Yn,Kn=G;function ea(e,r){var t=this.__data__,n=Kn(t,e);return n<0?(++this.size,t.push([e,r])):t[n][1]=r,this}o(ea,"qa");var ra=ea,ta=Bn,na=Wn,aa=Gn,oa=Zn,ia=ra;function q(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}o(q,"I");q.prototype.clear=ta;q.prototype.delete=na;q.prototype.get=aa;q.prototype.has=oa;q.prototype.set=ia;var X=q,sa=N,ca=O,ua=sa(ca,"Map"),ye=ua,Be=Un,la=X,fa=ye;function da(){this.size=0,this.__data__={hash:new Be,map:new(fa||la),string:new Be}}o(da,"rn");var ha=da;function pa(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}o(pa,"nn");var ya=pa,ba=ya;function va(e,r){var t=e.__data__;return ba(r)?t[typeof r=="string"?"string":"hash"]:t.map}o(va,"cn");var Y=va,ga=Y;function ma(e){var r=ga(this,e).delete(e);return this.size-=r?1:0,r}o(ma,"un");var ja=ma,_a=Y;function wa(e){return _a(this,e).get(e)}o(wa,"hn");var Oa=wa,Aa=Y;function xa(e){return Aa(this,e).has(e)}o(xa,"yn");var Ea=xa,Ca=Y;function Na(e,r){var t=Ca(this,e),n=t.size;return t.set(e,r),this.size+=t.size==n?0:1,this}o(Na,"$n");var $a=Na,Sa=ha,qa=ja,Ta=Oa,Ia=Ea,Pa=$a;function T(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var n=e[r];this.set(n[0],n[1])}}o(T,"P");T.prototype.clear=Sa;T.prototype.delete=qa;T.prototype.get=Ta;T.prototype.has=Ia;T.prototype.set=Pa;var be=T,Ar=be,za="Expected a function";function ve(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(za);var t=o(function(){var n=arguments,a=r?r.apply(this,n):n[0],i=t.cache;if(i.has(a))return i.get(a);var s=e.apply(this,n);return t.cache=i.set(a,s)||i,s},"r");return t.cache=new(ve.Cache||Ar),t}o(ve,"fe");ve.Cache=Ar;var Ua=ve,Ra=Ua,Ba=500;function Ma(e){var r=Ra(e,function(n){return t.size===Ba&&t.clear(),n}),t=r.cache;return r}o(Ma,"In");var ka=Ma,Fa=ka,Da=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,La=/\\(\\)?/g,Qa=Fa(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Da,function(t,n,a,i){r.push(a?i.replace(La,"$1"):n||t)}),r}),Va=Qa;function Wa(e,r){for(var t=-1,n=e==null?0:e.length,a=Array(n);++t<n;)a[t]=r(e[t],t,e);return a}o(Wa,"Dn");var Ha=Wa,Me=U,Ja=Ha,Ga=E,Xa=he,Ya=1/0,ke=Me?Me.prototype:void 0,Fe=ke?ke.toString:void 0;function xr(e){if(typeof e=="string")return e;if(Ga(e))return Ja(e,xr)+"";if(Xa(e))return Fe?Fe.call(e):"";var r=e+"";return r=="0"&&1/e==-Ya?"-0":r}o(xr,"pt");var Za=xr,Ka=Za;function eo(e){return e==null?"":Ka(e)}o(eo,"zn");var ro=eo,to=E,no=Nt,ao=Va,oo=ro;function io(e,r){return to(e)?e:no(e,r)?[e]:ao(oo(e))}o(io,"Yn");var so=io,co=he,uo=1/0;function lo(e){if(typeof e=="string"||co(e))return e;var r=e+"";return r=="0"&&1/e==-uo?"-0":r}o(lo,"ts");var fo=lo,ho=so,po=fo;function yo(e,r){r=ho(r,e);for(var t=0,n=r.length;e!=null&&t<n;)e=e[po(r[t++])];return t&&t==n?e:void 0}o(yo,"ss");var bo=yo,vo=bo;function go(e,r,t){var n=e==null?void 0:vo(e,r);return n===void 0?t:n}o(go,"cs");var mo=go;const b=mr(mo);var jo=X;function _o(){this.__data__=new jo,this.size=0}o(_o,"fs");var wo=_o;function Oo(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}o(Oo,"hs");var Ao=Oo;function xo(e){return this.__data__.get(e)}o(xo,"ps");var Eo=xo;function Co(e){return this.__data__.has(e)}o(Co,"bs");var No=Co,$o=X,So=ye,qo=be,To=200;function Io(e,r){var t=this.__data__;if(t instanceof $o){var n=t.__data__;if(!So||n.length<To-1)return n.push([e,r]),this.size=++t.size,this;t=this.__data__=new qo(n)}return t.set(e,r),this.size=t.size,this}o(Io,"ws");var Po=Io,zo=X,Uo=wo,Ro=Ao,Bo=Eo,Mo=No,ko=Po;function I(e){var r=this.__data__=new zo(e);this.size=r.size}o(I,"x");I.prototype.clear=Uo;I.prototype.delete=Ro;I.prototype.get=Bo;I.prototype.has=Mo;I.prototype.set=ko;var ge=I;function Fo(e,r){for(var t=-1,n=e==null?0:e.length;++t<n&&r(e[t],t,e)!==!1;);return e}o(Fo,"Ps");var Do=Fo,Lo=N,Qo=function(){try{var e=Lo(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Vo=Qo,De=Vo;function Wo(e,r,t){r=="__proto__"&&De?De(e,r,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[r]=t}o(Wo,"Ls");var Er=Wo,Ho=Er,Jo=pe,Go=Object.prototype,Xo=Go.hasOwnProperty;function Yo(e,r,t){var n=e[r];(!(Xo.call(e,r)&&Jo(n,t))||t===void 0&&!(r in e))&&Ho(e,r,t)}o(Yo,"Gs");var Cr=Yo,Zo=Cr,Ko=Er;function ei(e,r,t,n){var a=!t;t||(t={});for(var i=-1,s=r.length;++i<s;){var c=r[i],u=n?n(t[c],e[c],c,t,e):void 0;u===void 0&&(u=e[c]),a?Ko(t,c,u):Zo(t,c,u)}return t}o(ei,"qs");var Z=ei;function ri(e,r){for(var t=-1,n=Array(e);++t<e;)n[t]=r(t);return n}o(ri,"zs");var ti=ri,ni=R,ai=C,oi="[object Arguments]";function ii(e){return ai(e)&&ni(e)==oi}o(ii,"Xs");var si=ii,Le=si,ci=C,Nr=Object.prototype,ui=Nr.hasOwnProperty,li=Nr.propertyIsEnumerable,fi=Le(function(){return arguments}())?Le:function(e){return ci(e)&&ui.call(e,"callee")&&!li.call(e,"callee")},di=fi,L={exports:{}};function hi(){return!1}o(hi,"ai");var pi=hi;L.exports;(function(e,r){var t=O,n=pi,a=r&&!r.nodeType&&r,i=a&&!0&&e&&!e.nodeType&&e,s=i&&i.exports===a,c=s?t.Buffer:void 0,u=c?c.isBuffer:void 0,l=u||n;e.exports=l})(L,L.exports);var me=L.exports,yi=9007199254740991,bi=/^(?:0|[1-9]\d*)$/;function vi(e,r){var t=typeof e;return r=r??yi,!!r&&(t=="number"||t!="symbol"&&bi.test(e))&&e>-1&&e%1==0&&e<r}o(vi,"oi");var gi=vi,mi=9007199254740991;function ji(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=mi}o(ji,"ui");var $r=ji,_i=R,wi=$r,Oi=C,Ai="[object Arguments]",xi="[object Array]",Ei="[object Boolean]",Ci="[object Date]",Ni="[object Error]",$i="[object Function]",Si="[object Map]",qi="[object Number]",Ti="[object Object]",Ii="[object RegExp]",Pi="[object Set]",zi="[object String]",Ui="[object WeakMap]",Ri="[object ArrayBuffer]",Bi="[object DataView]",Mi="[object Float32Array]",ki="[object Float64Array]",Fi="[object Int8Array]",Di="[object Int16Array]",Li="[object Int32Array]",Qi="[object Uint8Array]",Vi="[object Uint8ClampedArray]",Wi="[object Uint16Array]",Hi="[object Uint32Array]",y={};y[Mi]=y[ki]=y[Fi]=y[Di]=y[Li]=y[Qi]=y[Vi]=y[Wi]=y[Hi]=!0;y[Ai]=y[xi]=y[Ri]=y[Ei]=y[Bi]=y[Ci]=y[Ni]=y[$i]=y[Si]=y[qi]=y[Ti]=y[Ii]=y[Pi]=y[zi]=y[Ui]=!1;function Ji(e){return Oi(e)&&wi(e.length)&&!!y[_i(e)]}o(Ji,"Fi");var Gi=Ji;function Xi(e){return function(r){return e(r)}}o(Xi,"Ui");var je=Xi,Q={exports:{}};Q.exports;(function(e,r){var t=jr,n=r&&!r.nodeType&&r,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i&&t.process,c=function(){try{var u=a&&a.require&&a.require("util").types;return u||s&&s.binding&&s.binding("util")}catch{}}();e.exports=c})(Q,Q.exports);var _e=Q.exports,Yi=Gi,Zi=je,Qe=_e,Ve=Qe&&Qe.isTypedArray,Ki=Ve?Zi(Ve):Yi,Sr=Ki,es=ti,rs=di,ts=E,ns=me,as=gi,os=Sr,is=Object.prototype,ss=is.hasOwnProperty;function cs(e,r){var t=ts(e),n=!t&&rs(e),a=!t&&!n&&ns(e),i=!t&&!n&&!a&&os(e),s=t||n||a||i,c=s?es(e.length,String):[],u=c.length;for(var l in e)(r||ss.call(e,l))&&!(s&&(l=="length"||a&&(l=="offset"||l=="parent")||i&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||as(l,u)))&&c.push(l);return c}o(cs,"Zi");var qr=cs,us=Object.prototype;function ls(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||us;return e===t}o(ls,"eo");var we=ls;function fs(e,r){return function(t){return e(r(t))}}o(fs,"to");var Tr=fs,ds=Tr,hs=ds(Object.keys,Object),ps=hs,ys=we,bs=ps,vs=Object.prototype,gs=vs.hasOwnProperty;function ms(e){if(!ys(e))return bs(e);var r=[];for(var t in Object(e))gs.call(e,t)&&t!="constructor"&&r.push(t);return r}o(ms,"lo");var js=ms,_s=wr,ws=$r;function Os(e){return e!=null&&ws(e.length)&&!_s(e)}o(Os,"go");var Ir=Os,As=qr,xs=js,Es=Ir;function Cs(e){return Es(e)?As(e):xs(e)}o(Cs,"vo");var K=Cs,Ns=Z,$s=K;function Ss(e,r){return e&&Ns(r,$s(r),e)}o(Ss,"mo");var qs=Ss;function Ts(e){var r=[];if(e!=null)for(var t in Object(e))r.push(t);return r}o(Ts,"wo");var Is=Ts,Ps=$,zs=we,Us=Is,Rs=Object.prototype,Bs=Rs.hasOwnProperty;function Ms(e){if(!Ps(e))return Us(e);var r=zs(e),t=[];for(var n in e)n=="constructor"&&(r||!Bs.call(e,n))||t.push(n);return t}o(Ms,"Io");var ks=Ms,Fs=qr,Ds=ks,Ls=Ir;function Qs(e){return Ls(e)?Fs(e,!0):Ds(e)}o(Qs,"Ro");var Oe=Qs,Vs=Z,Ws=Oe;function Hs(e,r){return e&&Vs(r,Ws(r),e)}o(Hs,"Fo");var Js=Hs,V={exports:{}};V.exports;(function(e,r){var t=O,n=r&&!r.nodeType&&r,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,s=i?t.Buffer:void 0,c=s?s.allocUnsafe:void 0;function u(l,f){if(f)return l.slice();var p=l.length,d=c?c(p):new l.constructor(p);return l.copy(d),d}o(u,"c"),e.exports=u})(V,V.exports);var Gs=V.exports;function Xs(e,r){var t=-1,n=e.length;for(r||(r=Array(n));++t<n;)r[t]=e[t];return r}o(Xs,"Go");var Ys=Xs;function Zs(e,r){for(var t=-1,n=e==null?0:e.length,a=0,i=[];++t<n;){var s=e[t];r(s,t,e)&&(i[a++]=s)}return i}o(Zs,"Ho");var Ks=Zs;function ec(){return[]}o(ec,"zo");var Pr=ec,rc=Ks,tc=Pr,nc=Object.prototype,ac=nc.propertyIsEnumerable,We=Object.getOwnPropertySymbols,oc=We?function(e){return e==null?[]:(e=Object(e),rc(We(e),function(r){return ac.call(e,r)}))}:tc,Ae=oc,ic=Z,sc=Ae;function cc(e,r){return ic(e,sc(e),r)}o(cc,"ko");var uc=cc;function lc(e,r){for(var t=-1,n=r.length,a=e.length;++t<n;)e[a+t]=r[t];return e}o(lc,"tc");var zr=lc,fc=Tr,dc=fc(Object.getPrototypeOf,Object),Ur=dc,hc=zr,pc=Ur,yc=Ae,bc=Pr,vc=Object.getOwnPropertySymbols,gc=vc?function(e){for(var r=[];e;)hc(r,yc(e)),e=pc(e);return r}:bc,Rr=gc,mc=Z,jc=Rr;function _c(e,r){return mc(e,jc(e),r)}o(_c,"dc");var wc=_c,Oc=zr,Ac=E;function xc(e,r,t){var n=r(e);return Ac(e)?n:Oc(n,t(e))}o(xc,"yc");var Br=xc,Ec=Br,Cc=Ae,Nc=K;function $c(e){return Ec(e,Nc,Cc)}o($c,"_c");var Mr=$c,Sc=Br,qc=Rr,Tc=Oe;function Ic(e){return Sc(e,Tc,qc)}o(Ic,"Tc");var Pc=Ic,zc=N,Uc=O,Rc=zc(Uc,"DataView"),Bc=Rc,Mc=N,kc=O,Fc=Mc(kc,"Promise"),Dc=Fc,Lc=N,Qc=O,Vc=Lc(Qc,"Set"),Wc=Vc,Hc=N,Jc=O,Gc=Hc(Jc,"WeakMap"),Xc=Gc,ae=Bc,oe=ye,ie=Dc,se=Wc,ce=Xc,kr=R,P=Or,He="[object Map]",Yc="[object Object]",Je="[object Promise]",Ge="[object Set]",Xe="[object WeakMap]",Ye="[object DataView]",Zc=P(ae),Kc=P(oe),eu=P(ie),ru=P(se),tu=P(ce),x=kr;(ae&&x(new ae(new ArrayBuffer(1)))!=Ye||oe&&x(new oe)!=He||ie&&x(ie.resolve())!=Je||se&&x(new se)!=Ge||ce&&x(new ce)!=Xe)&&(x=o(function(e){var r=kr(e),t=r==Yc?e.constructor:void 0,n=t?P(t):"";if(n)switch(n){case Zc:return Ye;case Kc:return He;case eu:return Je;case ru:return Ge;case tu:return Xe}return r},"T"));var ee=x,nu=Object.prototype,au=nu.hasOwnProperty;function ou(e){var r=e.length,t=new e.constructor(r);return r&&typeof e[0]=="string"&&au.call(e,"index")&&(t.index=e.index,t.input=e.input),t}o(ou,"Xc");var iu=ou,su=O,cu=su.Uint8Array,Fr=cu,Ze=Fr;function uu(e){var r=new e.constructor(e.byteLength);return new Ze(r).set(new Ze(e)),r}o(uu,"el");var xe=uu,lu=xe;function fu(e,r){var t=r?lu(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}o(fu,"rl");var du=fu,hu=/\w*$/;function pu(e){var r=new e.constructor(e.source,hu.exec(e));return r.lastIndex=e.lastIndex,r}o(pu,"sl");var yu=pu,Ke=U,er=Ke?Ke.prototype:void 0,rr=er?er.valueOf:void 0;function bu(e){return rr?Object(rr.call(e)):{}}o(bu,"ol");var vu=bu,gu=xe;function mu(e,r){var t=r?gu(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}o(mu,"ul");var ju=mu,_u=xe,wu=du,Ou=yu,Au=vu,xu=ju,Eu="[object Boolean]",Cu="[object Date]",Nu="[object Map]",$u="[object Number]",Su="[object RegExp]",qu="[object Set]",Tu="[object String]",Iu="[object Symbol]",Pu="[object ArrayBuffer]",zu="[object DataView]",Uu="[object Float32Array]",Ru="[object Float64Array]",Bu="[object Int8Array]",Mu="[object Int16Array]",ku="[object Int32Array]",Fu="[object Uint8Array]",Du="[object Uint8ClampedArray]",Lu="[object Uint16Array]",Qu="[object Uint32Array]";function Vu(e,r,t){var n=e.constructor;switch(r){case Pu:return _u(e);case Eu:case Cu:return new n(+e);case zu:return wu(e,t);case Uu:case Ru:case Bu:case Mu:case ku:case Fu:case Du:case Lu:case Qu:return xu(e,t);case Nu:return new n;case $u:case Tu:return new n(e);case Su:return Ou(e);case qu:return new n;case Iu:return Au(e)}}o(Vu,"Ll");var Wu=Vu,Hu=$,tr=Object.create,Ju=function(){function e(){}return o(e,"t"),function(r){if(!Hu(r))return{};if(tr)return tr(r);e.prototype=r;var t=new e;return e.prototype=void 0,t}}(),Gu=Ju,Xu=Gu,Yu=Ur,Zu=we;function Ku(e){return typeof e.constructor=="function"&&!Zu(e)?Xu(Yu(e)):{}}o(Ku,"ql");var el=Ku,rl=ee,tl=C,nl="[object Map]";function al(e){return tl(e)&&rl(e)==nl}o(al,"Wl");var ol=al,il=ol,sl=je,nr=_e,ar=nr&&nr.isMap,cl=ar?sl(ar):il,ul=cl,ll=ee,fl=C,dl="[object Set]";function hl(e){return fl(e)&&ll(e)==dl}o(hl,"nu");var pl=hl,yl=pl,bl=je,or=_e,ir=or&&or.isSet,vl=ir?bl(ir):yl,gl=vl,ml=ge,jl=Do,_l=Cr,wl=qs,Ol=Js,Al=Gs,xl=Ys,El=uc,Cl=wc,Nl=Mr,$l=Pc,Sl=ee,ql=iu,Tl=Wu,Il=el,Pl=E,zl=me,Ul=ul,Rl=$,Bl=gl,Ml=K,kl=Oe,Fl=1,Dl=2,Ll=4,Dr="[object Arguments]",Ql="[object Array]",Vl="[object Boolean]",Wl="[object Date]",Hl="[object Error]",Lr="[object Function]",Jl="[object GeneratorFunction]",Gl="[object Map]",Xl="[object Number]",Qr="[object Object]",Yl="[object RegExp]",Zl="[object Set]",Kl="[object String]",ef="[object Symbol]",rf="[object WeakMap]",tf="[object ArrayBuffer]",nf="[object DataView]",af="[object Float32Array]",of="[object Float64Array]",sf="[object Int8Array]",cf="[object Int16Array]",uf="[object Int32Array]",lf="[object Uint8Array]",ff="[object Uint8ClampedArray]",df="[object Uint16Array]",hf="[object Uint32Array]",h={};h[Dr]=h[Ql]=h[tf]=h[nf]=h[Vl]=h[Wl]=h[af]=h[of]=h[sf]=h[cf]=h[uf]=h[Gl]=h[Xl]=h[Qr]=h[Yl]=h[Zl]=h[Kl]=h[ef]=h[lf]=h[ff]=h[df]=h[hf]=!0;h[Hl]=h[Lr]=h[rf]=!1;function D(e,r,t,n,a,i){var s,c=r&Fl,u=r&Dl,l=r&Ll;if(t&&(s=a?t(e,n,a,i):t(e)),s!==void 0)return s;if(!Rl(e))return e;var f=Pl(e);if(f){if(s=ql(e),!c)return xl(e,s)}else{var p=Sl(e),d=p==Lr||p==Jl;if(zl(e))return Al(e,c);if(p==Qr||p==Dr||d&&!a){if(s=u||d?{}:Il(e),!c)return u?Cl(e,Ol(s,e)):El(e,wl(s,e))}else{if(!h[p])return a?e:{};s=Tl(e,p,c)}}i||(i=new ml);var w=i.get(e);if(w)return w;i.set(e,s),Bl(e)?e.forEach(function(g){s.add(D(g,r,t,g,e,i))}):Ul(e)&&e.forEach(function(g,m){s.set(m,D(g,r,t,m,e,i))});var j=l?u?$l:Nl:u?kl:Ml,_=f?void 0:j(e);return jl(_||e,function(g,m){_&&(m=g,g=e[m]),_l(s,m,D(g,r,t,m,e,i))}),s}o(D,"G");var pf=D,yf="__lodash_hash_undefined__";function bf(e){return this.__data__.set(e,yf),this}o(bf,"of");var vf=bf;function gf(e){return this.__data__.has(e)}o(gf,"lf");var mf=gf,jf=be,_f=vf,wf=mf;function W(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new jf;++r<t;)this.add(e[r])}o(W,"z");W.prototype.add=W.prototype.push=_f;W.prototype.has=wf;var Of=W;function Af(e,r){for(var t=-1,n=e==null?0:e.length;++t<n;)if(r(e[t],t,e))return!0;return!1}o(Af,"pf");var xf=Af;function Ef(e,r){return e.has(r)}o(Ef,"bf");var Cf=Ef,Nf=Of,$f=xf,Sf=Cf,qf=1,Tf=2;function If(e,r,t,n,a,i){var s=t&qf,c=e.length,u=r.length;if(c!=u&&!(s&&u>c))return!1;var l=i.get(e),f=i.get(r);if(l&&f)return l==r&&f==e;var p=-1,d=!0,w=t&Tf?new Nf:void 0;for(i.set(e,r),i.set(r,e);++p<c;){var j=e[p],_=r[p];if(n)var g=s?n(_,j,p,r,e,i):n(j,_,p,e,r,i);if(g!==void 0){if(g)continue;d=!1;break}if(w){if(!$f(r,function(m,A){if(!Sf(w,A)&&(j===m||a(j,m,t,n,i)))return w.push(A)})){d=!1;break}}else if(!(j===_||a(j,_,t,n,i))){d=!1;break}}return i.delete(e),i.delete(r),d}o(If,"Tf");var Vr=If;function Pf(e){var r=-1,t=Array(e.size);return e.forEach(function(n,a){t[++r]=[a,n]}),t}o(Pf,"Of");var zf=Pf;function Uf(e){var r=-1,t=Array(e.size);return e.forEach(function(n){t[++r]=n}),t}o(Uf,"Sf");var Rf=Uf,sr=U,cr=Fr,Bf=pe,Mf=Vr,kf=zf,Ff=Rf,Df=1,Lf=2,Qf="[object Boolean]",Vf="[object Date]",Wf="[object Error]",Hf="[object Map]",Jf="[object Number]",Gf="[object RegExp]",Xf="[object Set]",Yf="[object String]",Zf="[object Symbol]",Kf="[object ArrayBuffer]",ed="[object DataView]",ur=sr?sr.prototype:void 0,te=ur?ur.valueOf:void 0;function rd(e,r,t,n,a,i,s){switch(t){case ed:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case Kf:return!(e.byteLength!=r.byteLength||!i(new cr(e),new cr(r)));case Qf:case Vf:case Jf:return Bf(+e,+r);case Wf:return e.name==r.name&&e.message==r.message;case Gf:case Yf:return e==r+"";case Hf:var c=kf;case Xf:var u=n&Df;if(c||(c=Ff),e.size!=r.size&&!u)return!1;var l=s.get(e);if(l)return l==r;n|=Lf,s.set(e,r);var f=Mf(c(e),c(r),n,a,i,s);return s.delete(e),f;case Zf:if(te)return te.call(e)==te.call(r)}return!1}o(rd,"Vf");var td=rd,lr=Mr,nd=1,ad=Object.prototype,od=ad.hasOwnProperty;function id(e,r,t,n,a,i){var s=t&nd,c=lr(e),u=c.length,l=lr(r),f=l.length;if(u!=f&&!s)return!1;for(var p=u;p--;){var d=c[p];if(!(s?d in r:od.call(r,d)))return!1}var w=i.get(e),j=i.get(r);if(w&&j)return w==r&&j==e;var _=!0;i.set(e,r),i.set(r,e);for(var g=s;++p<u;){d=c[p];var m=e[d],A=r[d];if(n)var qe=s?n(A,m,d,r,e,i):n(m,A,d,e,r,i);if(!(qe===void 0?m===A||a(m,A,t,n,i):qe)){_=!1;break}g||(g=d=="constructor")}if(_&&!g){var B=e.constructor,M=r.constructor;B!=M&&"constructor"in e&&"constructor"in r&&!(typeof B=="function"&&B instanceof B&&typeof M=="function"&&M instanceof M)&&(_=!1)}return i.delete(e),i.delete(r),_}o(id,"Yf");var sd=id,ne=ge,cd=Vr,ud=td,ld=sd,fr=ee,dr=E,hr=me,fd=Sr,dd=1,pr="[object Arguments]",yr="[object Array]",F="[object Object]",hd=Object.prototype,br=hd.hasOwnProperty;function pd(e,r,t,n,a,i){var s=dr(e),c=dr(r),u=s?yr:fr(e),l=c?yr:fr(r);u=u==pr?F:u,l=l==pr?F:l;var f=u==F,p=l==F,d=u==l;if(d&&hr(e)){if(!hr(r))return!1;s=!0,f=!1}if(d&&!f)return i||(i=new ne),s||fd(e)?cd(e,r,t,n,a,i):ud(e,r,u,t,n,a,i);if(!(t&dd)){var w=f&&br.call(e,"__wrapped__"),j=p&&br.call(r,"__wrapped__");if(w||j){var _=w?e.value():e,g=j?r.value():r;return i||(i=new ne),a(_,g,t,n,i)}}return d?(i||(i=new ne),ld(e,r,t,n,a,i)):!1}o(pd,"sd");var yd=pd,bd=yd,vr=C;function Wr(e,r,t,n,a){return e===r?!0:e==null||r==null||!vr(e)&&!vr(r)?e!==e&&r!==r:bd(e,r,t,n,Wr,a)}o(Wr,"Lt");var vd=Wr,gd=ge,md=vd,jd=1,_d=2;function wd(e,r,t,n){var a=t.length,i=a,s=!n;if(e==null)return!i;for(e=Object(e);a--;){var c=t[a];if(s&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<i;){c=t[a];var u=c[0],l=e[u],f=c[1];if(s&&c[2]){if(l===void 0&&!(u in e))return!1}else{var p=new gd;if(n)var d=n(l,f,u,e,r,p);if(!(d===void 0?md(f,l,jd|_d,n,p):d))return!1}}return!0}o(wd,"hd");var Od=wd,Ad=$;function xd(e){return e===e&&!Ad(e)}o(xd,"yd");var Ed=xd,Cd=Ed,Nd=K;function $d(e){for(var r=Nd(e),t=r.length;t--;){var n=r[t],a=e[n];r[t]=[n,a,Cd(a)]}return r}o($d,"_d");var Sd=$d;function qd(e,r){return function(t){return t==null?!1:t[e]===r&&(r!==void 0||e in Object(t))}}o(qd,"Ad");var Td=qd,Id=Od,Pd=Sd,zd=Td;function Ud(e){var r=Pd(e);return r.length==1&&r[0][2]?zd(r[0][0],r[0][1]):function(t){return t===e||Id(t,e,r)}}o(Ud,"Sd");var Rd=Ud,Bd=pf,Md=Rd,kd=1;function Fd(e){return Md(Bd(e,kd))}o(Fd,"xd");var Dd=Fd;const Ld=mr(Dd),Ee=class Ee{constructor({items:r=[],identifierName:t="id",getNewId:n}={}){if(v(this,"sequence",0),v(this,"items",[]),v(this,"database",null),v(this,"name",null),v(this,"identifierName","id"),v(this,"getNewId"),!Array.isArray(r))throw new Error("Can't initialize a Collection with anything else than an array of items");this.identifierName=t,this.getNewId=n||this.getNewIdFromSequence,r.map(this.addOne.bind(this))}setDatabase(r){this.database=r}setName(r){this.name=r}_oneToManyEmbedder(r){if(this.name==null)throw new Error("Can't embed references without a collection name");const t=`${this.name.slice(0,-1)}_id`;return n=>{if(this.database==null)throw new Error("Can't embed references without a database");const a=this.database.collections[r];if(!a)throw new Error(`Can't embed a non-existing collection ${r}`);return Array.isArray(n[r])?n[r]=a.getAll({filter:o(i=>n[r].indexOf(i[a.identifierName])!==-1,"filter")}):n[r]=a.getAll({filter:o(i=>i[t]===n[this.identifierName],"filter")}),n}}_manyToOneEmbedder(r){const t=`${r}s`,n=`${r}_id`;return a=>{if(this.database==null)throw new Error("Can't embed references without a database");const i=this.database.collections[t];if(!i)throw new Error(`Can't embed a non-existing collection ${r}`);try{a[r]=i.getOne(a[n])}catch{}return a}}_itemEmbedder(r){const t=(Array.isArray(r)?r:[r]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>t.reduce((a,i)=>i(a),n)}getCount(r){return this.getAll(r).length}getAll(r){let t=this.items.slice(0);return r&&(r.filter&&(t=Hr(t,r.filter)),r.sort&&(t=Hd(t,r.sort)),r.range&&(t=Jd(t,r.range)),t=t.map(n=>Object.assign({},n)),r.embed&&this.database&&(t=t.map(this._itemEmbedder(r.embed)))),t}getIndex(r){return this.items.findIndex(t=>t[this.identifierName]==r)}getOne(r,t){const n=this.getIndex(r);if(n===-1)throw new Error(`No item with identifier ${r}`);let a=this.items[n];return a=Object.assign({},a),t!=null&&t.embed&&this.database&&(a=this._itemEmbedder(t.embed)(a)),a}getNewIdFromSequence(){return this.sequence++}addOne(r){const t=r[this.identifierName];if(t!=null){if(this.getIndex(t)!==-1)throw new Error(`An item with the identifier ${t} already exists`);typeof t=="number"&&(this.sequence=Math.max(this.sequence,t)+1)}else r[this.identifierName]=this.getNewId();return this.items.push(r),Object.assign({},r)}updateOne(r,t){const n=this.getIndex(r);if(n===-1)throw new Error(`No item with identifier ${r}`);for(const a in t)this.items[n][a]=t[a];return Object.assign({},this.items[n])}removeOne(r){const t=this.getIndex(r);if(t===-1)throw new Error(`No item with identifier ${r}`);const n=this.items[t];return this.items.splice(t,1),typeof r=="number"&&r==this.sequence-1&&this.sequence--,n}};o(Ee,"ot");let H=Ee;const Qd=o((e,r)=>e.reduce((t,n)=>t&&r(n),!0),"Rd"),Vd=o((e,r)=>e.reduce((t,n)=>t||r(n),!1),"Ld"),Wd=o((e,r)=>e.reduce((t,n,a)=>{if(t!=null)return t;const i=e.slice(0,a+1).join("."),s=e.slice(a+1).join("."),c=b(r,i);return Array.isArray(c)&&a<e.length-1?[i,s]:void 0},void 0),"Dd"),gr=o((e,r)=>{if(e.indexOf("_q")!==-1){const t=e.replace(/(_q)$/,""),n=new RegExp(r.toString(),"i");return a=>{var i;return((i=b(a,t))==null?void 0:i.toString().match(n))!==null}}if(e.indexOf("_lte")!==-1){const t=e.replace(/(_lte)$/,"");return n=>b(n,t)<=r}if(e.indexOf("_gte")!==-1){const t=e.replace(/(_gte)$/,"");return n=>b(n,t)>=r}if(e.indexOf("_lt")!==-1){const t=e.replace(/(_lt)$/,"");return n=>b(n,t)<r}if(e.indexOf("_gt")!==-1){const t=e.replace(/(_gt)$/,"");return n=>b(n,t)>r}if(e.indexOf("_neq_any")!==-1){const t=e.replace(/(_neq_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.every(i=>b(a,t)!=i)}if(e.indexOf("_neq")!==-1){const t=e.replace(/(_neq)$/,"");return n=>b(n,t)!=r}if(e.indexOf("_eq_any")!==-1){const t=e.replace(/(_eq_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.some(i=>b(a,t)==i)}if(e.indexOf("_eq")!==-1){const t=e.replace(/(_eq)$/,"");return n=>b(n,t)==r}if(e.indexOf("_inc_any")!==-1){const t=e.replace(/(_inc_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.some(i=>{const s=b(a,t);return Array.isArray(s)||typeof s=="string"?s.includes(i):!1})}if(e.indexOf("_inc")!==-1){const t=e.replace(/(_inc)$/,""),n=Array.isArray(r)?r:[r];return a=>n.every(i=>{const s=b(a,t);return Array.isArray(s)||typeof s=="string"?s.includes(i):!1})}if(e.indexOf("_ninc_any")!==-1){const t=e.replace(/(_ninc_any)$/,""),n=Array.isArray(r)?r:[r];return a=>n.every(i=>{const s=b(a,t);return Array.isArray(s)||typeof s=="string"?!s.includes(i):!1})}return Array.isArray(r)?t=>Array.isArray(b(t,e))?Qd(r,n=>{const a=b(t,e);return Array.isArray(a)?Vd(a,i=>i==n):!1}):r.filter(n=>n==b(t,e)).length>0:typeof r=="object"?t=>Ld(r)(b(t,e)):t=>{const n=b(t,e);return Array.isArray(n)&&typeof r=="string"?n.indexOf(r)!==-1:typeof n=="boolean"&&typeof r=="string"?n===(r==="true"):n==r}},"ct");function Hr(e,r){if(typeof r=="function")return e.filter(r);if(r instanceof Object){const t=Object.keys(r).map(n=>{if(n==="q"&&typeof r.q=="string"){const s=Gd(r.q),c=o(u=>{for(const l in u){const f=u[l];if(typeof f=="object"&&c(f)||f&&typeof f=="string"&&f.match&&f.match(s)!==null)return!0}return!1},"o");return c}const a=n.split("."),i=r[n];return a.length>1?s=>{const c=Wd(a,s);if(c){const[u,l]=c,f=b(s,u);return Array.isArray(f)?Hr(f,{[l]:i}).length>0:!1}return gr(n,i)(s)}:gr(n,i)});return e.filter(n=>t.reduce((a,i)=>a&&i(n),!0))}throw new Error("Unsupported filter type")}o(Hr,"Dt");function Hd(e,r){if(typeof r=="function")return e.sort(r);if(typeof r=="string")return e.sort((t,n)=>t[r]>n[r]?1:t[r]<n[r]?-1:0);if(Array.isArray(r)){const t=r[0],n=r[1].toLowerCase()==="asc"?1:-1;return e.sort((a,i)=>a[t]>i[t]?n:a[t]<i[t]?-1*n:0)}throw new Error("Unsupported sort type")}o(Hd,"Fd");function Jd(e,r){if(Array.isArray(r))return e.slice(r[0],r[1]!==void 0?r[1]+1:void 0);throw new Error("Unsupported range type")}o(Jd,"Bd");function Gd(e){const r=e.trim().replace(/[.*+?^${}()|[\]\\]/g,"\\$&").split(" ").map(t=>`(${t})`).join("|");return new RegExp(r,"i")}o(Gd,"Ud");const Ce=class Ce{constructor(r){if(v(this,"obj",null),v(this,"database",null),v(this,"name",null),!(r instanceof Object))throw new Error("Can't initialize a Single with anything except an object");this.obj=r}setDatabase(r){this.database=r}setName(r){this.name=r}_oneToManyEmbedder(r){return t=>{if(this.database==null)throw new Error("Can't embed references without a database");const n=this.database.collections[r];if(!n)throw new Error(`Can't embed a non-existing collection ${r}`);return t[r]=n.getAll({filter:o(a=>t[r].indexOf(a[n.identifierName])!==-1,"filter")}),t}}_manyToOneEmbedder(r){const t=`${r}s`,n=`${r}_id`;return a=>{if(this.database==null)throw new Error("Can't embed references without a database");const i=this.database.collections[t];if(!i)throw new Error(`Can't embed a non-existing collection ${r}`);try{a[r]=i.getOne(a[n])}catch{}return a}}_itemEmbedder(r){const t=(Array.isArray(r)?r:[r]).map(n=>n.endsWith("s")?this._oneToManyEmbedder(n):this._manyToOneEmbedder(n));return n=>t.reduce((a,i)=>i(a),n)}getOnly(r){let t=this.obj;return r!=null&&r.embed&&this.database&&(t=Object.assign({},t),t=this._itemEmbedder(r.embed)(t)),t}updateOnly(r){if(this.obj==null)throw new Error("Can't update a non-existing object");for(const t in r)this.obj[t]=r[t];return this.obj}};o(Ce,"Gd");let ue=Ce;const Ne=class Ne{constructor({data:r,identifierName:t="id",getNewId:n}={}){v(this,"identifierName","id"),v(this,"collections",{}),v(this,"singles",{}),v(this,"getNewId"),this.getNewId=n,this.identifierName=t,r&&this.init(r)}init(r){for(const t in r){const n=r[t];Array.isArray(n)?this.addCollection(t,new H({items:n,identifierName:this.identifierName,getNewId:this.getNewId})):this.addSingle(t,new ue(n))}}addCollection(r,t){this.collections[r]=t,t.setDatabase(this),t.setName(r)}getCollection(r){return this.collections[r]}getCollectionNames(){return Object.keys(this.collections)}addSingle(r,t){this.singles[r]=t,t.setDatabase(this),t.setName(r)}getSingle(r){return this.singles[r]}getSingleNames(){return Object.keys(this.singles)}getCount(r,t){return this.collections[r].getCount(t)}getAll(r,t){return this.collections[r].getAll(t)}getOne(r,t,n){return this.collections[r].getOne(t,n)}addOne(r,t){return Object.prototype.hasOwnProperty.call(this.collections,r)||this.addCollection(r,new H({items:[],identifierName:this.identifierName,getNewId:this.getNewId})),this.collections[r].addOne(t)}updateOne(r,t,n){return this.collections[r].updateOne(t,n)}removeOne(r,t){return this.collections[r].removeOne(t)}getOnly(r,t){return this.singles[r].getOnly()}updateOnly(r,t){return this.singles[r].updateOnly(t)}};o(Ne,"Kd");let le=Ne;const $e=class $e{constructor({baseUrl:r="",defaultQuery:t=o(()=>({}),"r"),database:n,middlewares:a,...i}={}){v(this,"baseUrl",""),v(this,"defaultQuery",()=>({})),v(this,"middlewares"),v(this,"database"),this.baseUrl=r,this.defaultQuery=t,this.middlewares=a||[],n?this.database=n:this.database=new le(i)}setDefaultQuery(r){this.defaultQuery=r}getContext(r){var t,n;for(const i of this.database.getSingleNames())if((t=r.url)!=null&&t.match(new RegExp(`^${this.baseUrl}\\/(${i})(\\/?.*)?$`)))return{...r,single:i};const a=(n=r.url)==null?void 0:n.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(a){const i=a[1],s=Object.assign({},this.defaultQuery(i),r.params);return{...r,collection:i,params:s}}return r}async handle(r){const t=this.getContext(r);let n=0;const a=[...this.middlewares],i=o(s=>{const c=a[n++];return c?c(s,i):this.handleRequest(s)},"s");try{return await i(t)}catch(s){if(s instanceof Error)throw s;return s}}handleRequest(r){var t,n;for(const c of this.database.getSingleNames())if((t=r.url)!=null&&t.match(new RegExp(`^${this.baseUrl}\\/(${c})(\\/?.*)?$`))){if(r.method==="GET")try{return{status:200,body:this.database.getOnly(c),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PUT")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PATCH")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOnly(c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}const a=(n=r.url)==null?void 0:n.match(new RegExp(`^${this.baseUrl}\\/([^\\/?]+)(\\/(\\w+|\\d+))?(\\?.*)?$`));if(!a)return{status:404,headers:{}};const i=a[1],s=Object.assign({},this.defaultQuery(i),r.params);if(a[2]){if(!this.database.getCollection(i))return{status:404,headers:{}};const c=a[3];if(r.method==="GET")try{return{status:200,body:this.database.getOne(i,c,s),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PUT")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(i,c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="PATCH")try{return r.requestBody==null?{status:400,headers:{}}:{status:200,body:this.database.updateOne(i,c,r.requestBody),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}if(r.method==="DELETE")try{return{status:200,body:this.database.removeOne(i,c),headers:{"Content-Type":"application/json"}}}catch{return{status:404,headers:{}}}}else{if(r.method==="GET"){if(!this.database.getCollection(i))return{status:404,headers:{}};const c=this.database.getCount(i,s.filter?{filter:s.filter}:{});if(c>0){const u=this.database.getAll(i,s),l=s.range?s.range[0]:0,f=s.range&&s.range.length===2?Math.min(u.length-1+l,s.range[1]):u.length-1;return{status:u.length===c?200:206,body:u,headers:{"Content-Type":"application/json","Content-Range":`items ${l}-${f}/${c}`}}}return{status:200,body:[],headers:{"Content-Type":"application/json","Content-Range":"items */0"}}}if(r.method==="POST"){if(r.requestBody==null)return{status:400,headers:{}};const c=this.database.addOne(i,r.requestBody),u=`${this.baseUrl}/${i}/${c[this.database.getCollection(i).identifierName]}`;return{status:201,body:c,headers:{"Content-Type":"application/json",Location:u}}}}return{status:404,headers:{}}}addMiddleware(r){this.middlewares.push(r)}addCollection(r,t){this.database.addCollection(r,t)}getCollection(r){return this.database.getCollection(r)}getCollectionNames(){return this.database.getCollectionNames()}addSingle(r,t){this.database.addSingle(r,t)}getSingle(r){return this.database.getSingle(r)}getSingleNames(){return this.database.getSingleNames()}};o($e,"_e");let fe=$e;function Xd(e){if(!e)return{};const r={};return e.split("&").map(t=>{if(t.indexOf("=")===-1)r[t]=!0;else{let[n,a]=t.split("=");(a.indexOf("[")===0||a.indexOf("{")===0)&&(a=JSON.parse(a)),r[n.trim()]=a}}),r}o(Xd,"Ft");const Se=class Se{constructor({loggingEnabled:r=!1,server:t,...n}={}){v(this,"loggingEnabled",!1),v(this,"server"),this.server=t||new fe(n),this.loggingEnabled=r}getHandler(){return async(r,t)=>{const n=new Request(r,t),a=await this.getNormalizedRequest(n),i=await this.server.handle(a);return this.log(n,i,a),i}}async getNormalizedRequest(r){const t=typeof r=="string"?new Request(r):r,n=t.url?decodeURIComponent(t.url.slice(t.url.indexOf("?")+1)):"",a=Xd(n),i=await t.text();let s;try{s=JSON.parse(i)}catch{}return{url:t.url,headers:t.headers,params:a,requestBody:s,method:t.method}}log(r,t,n){this.loggingEnabled&&(console.group?(console.groupCollapsed(n.method,n.url,"(FakeRest)"),console.group("request"),console.log(n.method,n.url),console.log("headers",r.headers),console.log("body   ",r.requestJson),console.groupEnd(),console.group("response",t.status),console.log("headers",t.headers),console.log("body   ",t.body),console.groupEnd(),console.groupEnd()):(console.log("FakeRest request ",n.method,n.url,"headers",r.headers,"body",r.requestJson),console.log("FakeRest response",t.status,"headers",t.headers,"body",t.body)))}toggleLogging(){this.loggingEnabled=!this.loggingEnabled}};o(Se,"Ut");let de=Se;const Yd=o(e=>(r,t)=>new Promise(n=>{setTimeout(()=>{n(t(r))},e)}),"Xd"),rh=o(()=>{const e=Gr(),r=new de({baseUrl:"http://localhost:4000",data:e,loggingEnabled:!0,middlewares:[Yd(500)]});return window&&(window.restServer=r.server),Te.mock("begin:http://localhost:4000",r.getHandler()),()=>Te.restore()},"rest");export{rh as default};
//# sourceMappingURL=rest-B-200Oex.js.map
